// Generated by CoffeeScript 1.10.0

/*
    Usage
    lets say, to print a variable use, ?_ varName _?
 */
var Template;

Template = (function() {
  function Template() {}

  Template.parse = function(string, data) {
    var fn, i, j, len, lex, match, strB, variableRegex, vars;
    if (data == null) {
      data = void 0;
    }
    vars = [];
    variableRegex = /\?__[\ ]?(.*?)[\ ]?__\?/g;
    while (match = variableRegex.exec(string)) {
      string = string.replace(match[0], "??" + match[1]);
      variableRegex.lastIndex = match.index + match[1].length;
    }
    strB = string.replace(/[\n]/g, '..').replace(/[\r\t\n]/g, ' ').replace(/\?_\ ?(.*?)\ ?_\?/g, '..?$1..').trim();
    strB = strB.split('..');
    for (i = j = 0, len = strB.length; j < len; i = ++j) {
      lex = strB[i];
      if (lex.indexOf('??') === 0) {
        strB[i] = lex.replace('??', '');
      } else if (lex.indexOf('?') === 0) {
        lex = lex.replace('?', '');
        strB[i] = "p.push(" + lex + ");";
      } else {
        strB[i] = "p.push('" + lex + "');";
      }
    }
    fn = new Function('obj', "var p = []; with (obj) { " + (strB.join('\n')) + " } return p.join('').trim();");
    if (data) {
      return fn(data);
    } else {
      return fn;
    }
  };

  return Template;

})();
